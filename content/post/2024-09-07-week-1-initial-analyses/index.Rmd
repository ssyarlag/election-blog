---
title: Week 1 - Initial Analyses
author: Shriya Yarlagadda
date: '2024-09-07'
slug: week-1-initial-analyses
categories: []
tags: []
---

In this first blog post, I begin by conducting some initial analyses of the American elections. Using data from 1948-2020, I analyze how competitive elections are and the proportion of states that vote blue/red. My thanks to Matt Dardet for writing much of this code during and before our weekly section, as well as ShuXin Ho for helping me identify latitude/longitude loading bugs in my maps.


## Questions:
## 1: How competitive are presidential elections in the United States?
## 2: Which states vote blue/red and how consistently
## 3: Extension: Plot a swing map for each year. Which states are/have been battleground states? Which states are no longer battlegrounds?

To answer these questions, we began by observing general trends in preference for either of the two major parties' candidates between 1948 and 2020. We conducted analyses at both the national and state level. For the former, we produced a line plot of the two-party vote share per party in each election. For the latter, we used a map to visually break down the total percentage in the line plot by state, showing which candidate won each state in each election. 


```{r}
library(ggplot2)
library(maps)
library(tidyverse)

# Load in data
d_popvote <- read_csv('popvote_1948-2020.csv')

# Create pivoted dataset and add winner column
d_popvote_wide <- d_popvote |>
  select(year, party, pv2p) |>
  pivot_wider(names_from = party, values_from = pv2p) |>
  mutate(winner = ifelse(democrat > republican, "D", "R"))

```

```{r}

# Line plot demonstrating percentage of two-party popular vote per party 
line_plot_win_trend <- d_popvote |>
  ggplot(mapping = aes(x = year, y = pv2p, color = party)) +
  geom_line() +
  scale_color_manual(values = c("dodgerblue4", "firebrick1")) +
  theme_bw() +
  labs(title = "Percentage of Two-Party Popular Vote by Party, 1948-2020",
       x = "Year",
       y = "Two-Party Vote Percentage",
       color = "Party")

# Loading state data for map and formatting for compatibility
states_map <- map_data("state")
d_pvstate_wide <- read_csv("clean_wide_state_2pv_1948_2020.csv")
d_pvstate_wide$region = tolower(d_pvstate_wide$state)

# Creating new dataframe with winners highlighted
pop_2p_vote_w_state <- d_pvstate_wide |>
  left_join(states_map, by = "region") |>
  mutate(winner = ifelse(D_pv2p > R_pv2p, "D", "R"))

# Map of Two Party Popular Vote Winners by State
pop_2p_vote_winner_by_year_map <- pop_2p_vote_w_state |>
  ggplot(mapping = aes(x = long, y = lat, group = group)) + geom_polygon(aes(fill = winner), color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "firebrick1")) +
  facet_wrap(~year)+
  theme_void() +
  labs(title = "Two-Party Popular Vote Winners by State by Year")

line_plot_win_trend
pop_2p_vote_winner_by_year_map
  
```

To further explore state competitiveness, especially in recent years, I also produced the following map demonstrating the average two-party popular vote margin in each state in each election following 2008. I chose this cutoff to reflect modern trends in state-party alignment, especially in the era of Trump.

```{r}

pop_2p_vote_by_state_post2008 <- pop_2p_vote_w_state |>
  filter(year > 2008) |>
  mutate(margin = D_pv2p - R_pv2p) |>
  group_by(state, group, order, lat, long) |>
  summarize(average_margin = mean(margin))

map_pop_2p_vote_by_state_post2008 <- pop_2p_vote_by_state_post2008 |>
  ggplot(mapping = aes(x=long, y = lat, group = group)) +
  geom_polygon(aes(fill = average_margin), color = "black") +
  scale_fill_gradient2(high= "dodgerblue4",
                       mid = "purple3",
                       low = "firebrick1",
                       breaks = c(-50, -25, 0, 25, 50),
                       limits = c(-50,50)) +
  theme_void() +
  labs(title = "States by Average Two-Party Vote Share Margin post 2008",
       gradient = "Average Margin")


map_pop_2p_vote_by_state_post2008
```

States that are more red on this map have consistently tended to overwhelmingly vote Republican, while those that are more blue have consistently voted overwhelmingly Democrat. While states like California and Wyoming appear to often regularly vote Democrat and Republican respectively, it is interesting to observe cases like Ohio or Michigan, which may tend to lean Republican or Democrat, but have a much smaller margin, indicating greater competitiveness.

Then, to further understand what states have been battlegrounds, I created an additional map, which plots the degree to which a state's democratic vote share has changed. Assuming that any declines correspond to an equal increase in Republican vote share and increases correspond to an equal decline in Republican vote share (ie: we ignore third party candidates for now), this map shows if a state has become "redder" or "bluer" since the previous election.

```{r}
swing_maps_data <- pop_2p_vote_w_state |>
  mutate(swing = (D_pv2p) - (D_pv2p_lag1)) |>
  ggplot(aes(x = long, y = lat, group = group)) + 
  geom_polygon(aes(fill = swing), color = "black") +
  scale_fill_gradient2(low = "firebrick1",
                      mid = "white",
                      high = "dodgerblue4",
                      breaks = c(-20, -10, 0, 10, 20),
                      limits = c(-20,20)) +
  facet_wrap(~year) +
  theme_void() +
  labs(title = "Change in Vote Share Relative to Prior Election")

swing_maps_data
```

States on this map that appear to regularly alternate between increases (shown by a state being blue during an election in the above map) and decreases (shown by a state being red during an election in the above map) can be considered battleground states. These states have a lower chance of firmly voting for one party than states that are regularly only one color or appear to have little to no change relative to prior years (are white).

Based on this criteria, states like Michigan, Pennsylvania, Nevada, and Ohio appear to be swing states, including in recent years. This prediction also seems to align with the states that the US News has identified as swing states (https://www.usnews.com/news/elections/articles/7-swing-states-that-could-decide-the-2024-presidential-election). 
